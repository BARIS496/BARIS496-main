<!doctype html>
<html lang="tr">

<head>

    <script src='https://api.mapbox.com/mapbox-gl-js/v1.8.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.8.0/mapbox-gl.css' rel='stylesheet' />
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


    <style>
        .marker {
            background-image: url('mapbox-icon.png');
            background-size: cover;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <div>Map of Containers</div>

    <div id='map' style='width: 1500px; height: 500px;'></div>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoidG9sZ2FjYXJyIiwiYSI6ImNrN2FyZjQxdzAwZ2cza2xzMTN1N2hwcnAifQ.306dpufyPnw7zlYiZRLx-w';
        if (!mapboxgl.supported()) {
            alert('Your browser does not support Mapbox GL');
        } else {
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v11',
                center: [32.841853, 39.924145],
                zoom: 12
            });
        }

        $(document).ready(function () {

            // show list of containers on first load
            getContainers();

        });

        function getContainers() {
            $.getJSON("http://restservices496.herokuapp.com/containers", function (data) {
                $.each(data, function (key, value) {

                    var el = document.createElement('div');
                    el.className = 'marker';
                    var coordinates = [value.lng,value.lat];
                    if(value.lng == 123){

                    }
                    new mapboxgl.Marker(el)
                        .setLngLat(coordinates)
                        .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
                            .setHTML('<h3>Name: ' + value.name + '</h3><p>Type: '+ value.type +'<p>Weight: ' + value.weight + '</p>'))
                        .addTo(map);
                });
            });
        }
        
    </script>


</body>

</html>